"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useMachine = void 0;
var store_1 = require("svelte/store");
var fsm_1 = require("@xstate/fsm");
function useMachine(machine, options) {
    if (options === void 0) { options = {}; }
    var resolvedMachine = (0, fsm_1.createMachine)(machine.config, options ? options : machine._options);
    var service = (0, fsm_1.interpret)(resolvedMachine).start();
    var state = (0, store_1.readable)(service.state, function (set) {
        service.subscribe(function (state) {
            if (state.changed) {
                set(state);
            }
        });
        return function () {
            service.stop();
        };
    });
    return { state: state, send: service.send, service: service };
}
exports.useMachine = useMachine;
